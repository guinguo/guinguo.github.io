<!doctype html>



  


<html class="theme-next mist use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"/>




  <link href="//fonts.googleapis.com/css?family=Lato:300,400,700,400italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">



<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=0.5.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hadoop," />





  <link rel="alternate" href="/atom.xml" title="Guinguo's blog" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=0.5.0" />






<meta name="description" content="Hadoop2.7.2 HA集群搭建">
<meta property="og:type" content="article">
<meta property="og:title" content="Hadoop-Cluster-Set-Up-P3_Hadoop">
<meta property="og:url" content="http://www.guinguo.top/2016/07/23/Hadoop-Cluster-Set-Up-P3-Hadoop/index.html">
<meta property="og:site_name" content="Guinguo's blog">
<meta property="og:description" content="Hadoop2.7.2 HA集群搭建">
<meta property="og:updated_time" content="2016-07-23T15:46:45.983Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hadoop-Cluster-Set-Up-P3_Hadoop">
<meta name="twitter:description" content="Hadoop2.7.2 HA集群搭建">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>

  <title> Hadoop-Cluster-Set-Up-P3_Hadoop | Guinguo's blog </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  



  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?651f6694a8a016ae53eaffce893df97d";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>








  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Guinguo's blog</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">Just try it</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-home fa-fw"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-th fa-fw"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-archive fa-fw"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-tags fa-fw"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-user fa-fw"></i> <br />
            
            关于
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="#" class="st-search-show-outputs">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <form class="site-search-form">
  <input type="text" id="st-search-input" class="st-search-input st-default-search-input" />
</form>

<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
    (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
    e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install', 'Qh7UfB7sRNYosLvQWNGP','2.0.0');
</script>



    </div>
  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                Hadoop-Cluster-Set-Up-P3_Hadoop
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-07-23T15:27:44+08:00" content="2016-07-23">
              2016-07-23
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/BigData/" itemprop="url" rel="index">
                    <span itemprop="name">BigData</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/07/23/Hadoop-Cluster-Set-Up-P3-Hadoop/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/07/23/Hadoop-Cluster-Set-Up-P3-Hadoop/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="获取安装包"><a href="#获取安装包" class="headerlink" title="获取安装包"></a>获取安装包</h1><p>　　你可以拿到源码包然后重新编译一次，我直接下载解压版<br>使用</p>
<pre><code>wget http://archive.apache.org/dist/hadoop/core/current/hadoop-2.7.2.tar.gz
</code></pre><p>解压到 /usr/local下</p>
<pre><code>tar -zxvf hadoop-2.7.2.tar.gz -C /usr/local/
</code></pre><h1 id="修改配置文件"><a href="#修改配置文件" class="headerlink" title="修改配置文件"></a>修改配置文件</h1><ul>
<li>1、 core-site.xml<br>参考配置 <a href="https://hadoop.apache.org/docs/r2.4.1/hadoop-project-dist/hadoop-common/core-default.xml" title="core-default.xml" target="_blank" rel="external">core-default.xml</a></li>
</ul>
<pre><code>&lt;configuration&gt;
&lt;property&gt;
&lt;name&gt;fs.defaultFS&lt;/name&gt;
&lt;value&gt;hdfs://mycluster&lt;/value&gt;
&lt;/property&gt;

&lt;property&gt;
&lt;name&gt;hadoop.tmp.dir&lt;/name&gt;
&lt;value&gt;/home/root/hadoop/tmp&lt;/value&gt;
&lt;/property&gt;

&lt;property&gt;
&lt;name&gt;ha.zookeeper.quorum&lt;/name&gt;
&lt;value&gt;server1:2181,server2:2181,server3:2181&lt;/value&gt;
&lt;/property&gt;

&lt;property&gt;
&lt;name&gt;fs.trash.interval&lt;/name&gt;
&lt;value&gt;2000&lt;/value&gt;
&lt;/property&gt;
&lt;/configuration&gt;
</code></pre><p>说明：<br>　　hadoop.tmp.dir 是hadoop文件系统依赖的基础配置，很多路径都依赖它。如果hdfs-site.xml中不配 置namenode和datanode的存放位置，默认就放在这个路径中</p>
<p> 1、hadoop.tmp.dir</p>
<p> 2、dfs.datanode.data.dir    </p>
<p> 3、dfs.namenode.name.dir    </p>
<p> 4、dfs.namenode.edits.dir    </p>
<p> 5、dfs.namenode.checkpoint.dir    </p>
<p> 6、dfs.namenode.checkpoint.edits.dir    </p>
<hr>
<ul>
<li>2、hdfs-site.xml<br>参考配置 <a href="https://hadoop.apache.org/docs/r2.4.1/hadoop-project-dist/hadoop-hdfs/hdfs-default.xml" title="hdfs-default.xml" target="_blank" rel="external">hdfs-default.xml</a></li>
</ul>
<pre><code>&lt;configuration&gt;
&lt;property&gt;
&lt;name&gt;dfs.replication&lt;/name&gt;
&lt;value&gt;2&lt;/value&gt; &lt;!-- hdfs存的副本(数量) --&gt;
&lt;/property&gt;

&lt;property&gt;
&lt;name&gt;dfs.nameservices&lt;/name&gt; 
&lt;value&gt;mycluster&lt;/value&gt; &lt;!-- 服务的名称，可用逗号分隔 --&gt;
&lt;/property&gt;

&lt;property&gt;
&lt;name&gt;dfs.ha.namenodes.mycluster&lt;/name&gt; 
&lt;value&gt;nn1,nn2&lt;/value&gt; &lt;!-- HA的两个节点 --&gt;
&lt;/property&gt;

&lt;property&gt;
&lt;name&gt;dfs.namenode.rpc-address.mycluster.nn1&lt;/name&gt;
&lt;value&gt;server1:9000&lt;/value&gt; 
&lt;/property&gt;

&lt;property&gt;
&lt;name&gt;dfs.namenode.http-address.mycluster.nn1&lt;/name&gt;
&lt;value&gt;server1:50070&lt;/value&gt;
&lt;/property&gt;

&lt;property&gt;
&lt;name&gt;dfs.namenode.rpc-address.mycluster.nn2&lt;/name&gt; 
&lt;value&gt;server2:9000&lt;/value&gt; &lt;!--处理所有客户端请求--&gt;
&lt;/property&gt;

&lt;property&gt;
&lt;name&gt;dfs.namenode.http-address.mycluster.nn2&lt;/name&gt;
&lt;value&gt;server2:50070&lt;/value&gt; 
&lt;!--dfs namenode web ui监听的端口--&gt;
&lt;/property&gt;

&lt;property&gt;
&lt;name&gt;dfs.ha.automatic-failover.enabled.mycluster&lt;/name&gt;
&lt;value&gt;true&lt;/value&gt; &lt;!--启用HA--&gt;
&lt;/property&gt;

&lt;property&gt;
&lt;name&gt;dfs.namenode.shared.edits.dir&lt;/name&gt;
&lt;value&gt;qjournal://server1:8485;server2:8485;server3:8485/mycluster&lt;/value&gt;
&lt;/property&gt;

&lt;property&gt;
&lt;name&gt;dfs.journalnode.edits.dir&lt;/name&gt;
&lt;value&gt;/home/root/hadoop/tmp/journal&lt;/value&gt;
&lt;/property&gt;

&lt;property&gt; &lt;!--配置ssh登录信息--&gt;
&lt;name&gt;dfs.ha.fencing.methods&lt;/name&gt;
&lt;value&gt;sshfence&lt;/value&gt;
&lt;/property&gt;

&lt;property&gt;
&lt;name&gt;dfs.ha.fencing.ssh.private-key-files&lt;/name&gt;
&lt;value&gt;/root/.ssh/id_rsa&lt;/value&gt;
&lt;/property&gt;

&lt;property&gt;
&lt;name&gt;dfs.client.failover.proxy.provider.mycluster&lt;/name&gt;
&lt;value&gt;org.apache.hadoop.hdfs.server.namenode.ha.ConfiguredFailoverProxyProvider&lt;/value&gt;
&lt;/property&gt;
&lt;/configuration&gt;
</code></pre><ul>
<li>3、yarn-site.xml<br>参考配置 <a href="https://hadoop.apache.org/docs/r2.4.1/hadoop-yarn/hadoop-yarn-common/yarn-default.xml" title="yarn-default.xml" target="_blank" rel="external">yarn-default.xml</a></li>
</ul>
<pre><code>&lt;configuration&gt;    
&lt;property&gt;
  &lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt;
  &lt;value&gt;mapreduce_shuffle&lt;/value&gt;
&lt;/property&gt;

&lt;property&gt;
  &lt;name&gt;yarn.nodemanager.aux-services.mapreduce.shuffle.class&lt;/name&gt;
  &lt;value&gt;org.apache.hadoop.mapred.ShuffleHandler&lt;/value&gt;
&lt;/property&gt;

&lt;property&gt;
  &lt;name&gt;yarn.nodemanager.local-dirs&lt;/name&gt;
  &lt;value&gt;/home/root/hadoop/nm&lt;/value&gt;
&lt;/property&gt;

&lt;property&gt;
  &lt;name&gt;yarn.nodemanager.log-dirs&lt;/name&gt;
  &lt;value&gt;/home/root/hadoop/logs&lt;/value&gt;
&lt;/property&gt;

&lt;property&gt;
  &lt;name&gt;yarn.log-aggregation-enable&lt;/name&gt;
  &lt;value&gt;true&lt;/value&gt;
&lt;/property&gt; 

&lt;property&gt;
  &lt;description&gt;Where to aggregate logs&lt;/description&gt;
  &lt;name&gt;yarn.nodemanager.remote-app-log-dir&lt;/name&gt;
  &lt;value&gt;hdfs://mycluster/var/log/hadoop-yarn/apps&lt;/value&gt;
&lt;/property&gt;

&lt;!-- Resource Manager Configs --&gt;
&lt;property&gt;
  &lt;name&gt;yarn.resourcemanager.connect.retry-interval.ms&lt;/name&gt;
  &lt;value&gt;2000&lt;/value&gt;
&lt;/property&gt;

&lt;property&gt;
  &lt;name&gt;yarn.resourcemanager.ha.enabled&lt;/name&gt;
  &lt;value&gt;true&lt;/value&gt;
&lt;/property&gt;

&lt;property&gt;
  &lt;name&gt;yarn.resourcemanager.ha.automatic-failover.enabled&lt;/name&gt;
  &lt;value&gt;true&lt;/value&gt;
&lt;/property&gt;

&lt;property&gt;
  &lt;name&gt;yarn.resourcemanager.ha.automatic-failover.embedded&lt;/name&gt;
  &lt;value&gt;true&lt;/value&gt;
&lt;/property&gt;

&lt;property&gt;
  &lt;name&gt;yarn.resourcemanager.cluster-id&lt;/name&gt;
  &lt;value&gt;yarn-cluster&lt;/value&gt;
&lt;/property&gt;

&lt;property&gt;
  &lt;name&gt;yarn.resourcemanager.ha.rm-ids&lt;/name&gt;
  &lt;value&gt;rm1,rm2&lt;/value&gt;
&lt;/property&gt;

&lt;property&gt;
  &lt;name&gt;yarn.resourcemanager.ha.id&lt;/name&gt;
  &lt;value&gt;rm1&lt;/value&gt;
&lt;/property&gt;

&lt;property&gt;
  &lt;name&gt;yarn.resourcemanager.scheduler.class&lt;/name&gt;
  &lt;value&gt;org.apache.hadoop.yarn.server.resourcemanager.scheduler.fair.FairScheduler&lt;/value&gt;
&lt;/property&gt;

&lt;property&gt;
  &lt;name&gt;yarn.resourcemanager.recovery.enabled&lt;/name&gt;
  &lt;value&gt;true&lt;/value&gt;
&lt;/property&gt;

&lt;property&gt;
  &lt;name&gt;yarn.resourcemanager.store.class&lt;/name&gt;
  &lt;value&gt;org.apache.hadoop.yarn.server.resourcemanager.recovery.ZKRMStateStore&lt;/value&gt;
&lt;/property&gt;

&lt;property&gt;
  &lt;name&gt;yarn.resourcemanager.zk.state-store.address&lt;/name&gt;
  &lt;value&gt;server1:2181,server2:2181,server3:2181&lt;/value&gt;
&lt;/property&gt;

&lt;property&gt;
  &lt;name&gt;yarn.app.mapreduce.am.scheduler.connection.wait.interval-ms&lt;/name&gt;
  &lt;value&gt;5000&lt;/value&gt;
&lt;/property&gt;


  &lt;!-- RM1 configs --&gt;
&lt;property&gt;
  &lt;name&gt;yarn.resourcemanager.address.rm1&lt;/name&gt;
  &lt;value&gt;server1:23140&lt;/value&gt;
&lt;/property&gt;

&lt;property&gt;
  &lt;name&gt;yarn.resourcemanager.scheduler.address.rm1&lt;/name&gt;
  &lt;value&gt;server1:23130&lt;/value&gt;
&lt;/property&gt;

&lt;property&gt;
  &lt;name&gt;yarn.resourcemanager.webapp.https.address.rm1&lt;/name&gt;
  &lt;value&gt;server1:23189&lt;/value&gt;
&lt;/property&gt;

&lt;property&gt;
  &lt;name&gt;yarn.resourcemanager.webapp.address.rm1&lt;/name&gt;
  &lt;value&gt;server1:23188&lt;/value&gt;
&lt;/property&gt;

&lt;property&gt;
  &lt;name&gt;yarn.resourcemanager.resource-tracker.address.rm1&lt;/name&gt;
  &lt;value&gt;server1:23125&lt;/value&gt;
&lt;/property&gt;

&lt;property&gt;
  &lt;name&gt;yarn.resourcemanager.admin.address.rm1&lt;/name&gt;
  &lt;value&gt;server1:23141&lt;/value&gt;
&lt;/property&gt;


&lt;!-- RM2 configs --&gt;
&lt;property&gt;
  &lt;name&gt;yarn.resourcemanager.address.rm2&lt;/name&gt;
  &lt;value&gt;server2:23140&lt;/value&gt;
&lt;/property&gt;

&lt;property&gt;
  &lt;name&gt;yarn.resourcemanager.scheduler.address.rm2&lt;/name&gt;
  &lt;value&gt;server2:23130&lt;/value&gt;
&lt;/property&gt;

&lt;property&gt;
  &lt;name&gt;yarn.resourcemanager.webapp.https.address.rm2&lt;/name&gt;
  &lt;value&gt;server2:23189&lt;/value&gt;
&lt;/property&gt;

&lt;property&gt;
  &lt;name&gt;yarn.resourcemanager.webapp.address.rm2&lt;/name&gt;
  &lt;value&gt;server2:23188&lt;/value&gt;
&lt;/property&gt;

&lt;property&gt;
  &lt;name&gt;yarn.resourcemanager.resource-tracker.address.rm2&lt;/name&gt;
  &lt;value&gt;server2:23125&lt;/value&gt;
&lt;/property&gt;

&lt;property&gt;
  &lt;name&gt;yarn.resourcemanager.admin.address.rm2&lt;/name&gt;
  &lt;value&gt;server2:23141&lt;/value&gt;
&lt;/property&gt;


&lt;!-- Node Manager Configs --&gt;
&lt;property&gt;
  &lt;description&gt;Address where the localizer IPC is.&lt;/description&gt;
  &lt;name&gt;yarn.nodemanager.localizer.address&lt;/name&gt;
  &lt;value&gt;0.0.0.0:23344&lt;/value&gt;
&lt;/property&gt;

&lt;property&gt;
  &lt;description&gt;NM Webapp address.&lt;/description&gt;
  &lt;name&gt;yarn.nodemanager.webapp.address&lt;/name&gt;
  &lt;value&gt;0.0.0.0:23999&lt;/value&gt;
&lt;/property&gt;

  &lt;property&gt;
    &lt;name&gt;yarn.nodemanager.local-dirs&lt;/name&gt;
    &lt;value&gt;/home/root/hadoop/nodemanager/yarn/local&lt;/value&gt;
  &lt;/property&gt;

  &lt;property&gt;
    &lt;name&gt;yarn.nodemanager.log-dirs&lt;/name&gt;
    &lt;value&gt;/home/root/hadoop/nodemanager/yarn/log&lt;/value&gt;
  &lt;/property&gt;

&lt;property&gt;
  &lt;name&gt;mapreduce.shuffle.port&lt;/name&gt;
  &lt;value&gt;23080&lt;/value&gt;
&lt;/property&gt;

&lt;property&gt;
  &lt;name&gt;yarn.resourcemanager.zk-address&lt;/name&gt;
  &lt;value&gt;server1:2181,server2:2181,server3:2181&lt;/value&gt;
&lt;/property&gt;

&lt;/configuration&gt;
</code></pre><ul>
<li>4、mapred-site.xml<br>参考配置 <a href="https://hadoop.apache.org/docs/r2.7.1/hadoop-mapreduce-client/hadoop-mapreduce-client-core/mapred-default.xml" title="mapred-default.xml" target="_blank" rel="external">mapred-default.xml</a></li>
</ul>
<pre><code>&lt;configuration&gt;
&lt;property&gt;
    &lt;name&gt;mapreduce.jobhistory.address&lt;/name&gt;
    &lt;value&gt;server1:10020&lt;/value&gt;
&lt;/property&gt;
&lt;property&gt;
    &lt;name&gt;mapreduce.jobhistory.webapp.address&lt;/name&gt;
    &lt;value&gt;server1:19888&lt;/value&gt;
&lt;/property&gt;
&lt;property&gt;
    &lt;name&gt;mapreduce.jobhistory.webapp.https.address&lt;/name&gt;
    &lt;value&gt;server1:19890&lt;/value&gt;
&lt;/property&gt;
&lt;property&gt;
    &lt;name&gt;mapreduce.jobhistory.admin.address&lt;/name&gt;
    &lt;value&gt;server1:10033&lt;/value&gt;
&lt;/property&gt;
&lt;property&gt;
    &lt;name&gt;mapreduce.framework.name&lt;/name&gt;
    &lt;value&gt;yarn&lt;/value&gt;
&lt;/property&gt;
&lt;property&gt;
    &lt;name&gt;yarn.app.mapreduce.am.staging-dir&lt;/name&gt;
    &lt;value&gt;/user&lt;/value&gt;
&lt;/property&gt;
&lt;property&gt;
    &lt;name&gt;mapreduce.task.timeout&lt;/name&gt;
    &lt;value&gt;1800000&lt;/value&gt;
&lt;/property&gt;
&lt;/configuration&gt;
</code></pre><ul>
<li>5、slaves </li>
</ul>
<pre><code>vi slaves

server3
server4
</code></pre><ul>
<li>6、hadoop-env.sh修改<br>  JAVA_HOME指定为jdk安装目录，JAVA_HOME=/usr/local/jdk1.7.0_79</li>
</ul>
<h1 id="复制到其他节点"><a href="#复制到其他节点" class="headerlink" title="复制到其他节点"></a>复制到其他节点</h1><ul>
<li>7、scp hadoop-2.7.2</li>
</ul>
<pre><code>[root@server1 local]# scp -rq hadoop-2.7.2 server2:/usr/local/
[root@server1 local]# scp -rq hadoop-2.7.2 server3:/usr/local/
[root@server1 local]# scp -rq hadoop-2.7.2 server4:/usr/local/
</code></pre><h1 id="启动各种服务"><a href="#启动各种服务" class="headerlink" title="启动各种服务"></a>启动各种服务</h1><ul>
<li>8、启动journalnode</li>
</ul>
<pre><code>[root@server1 local]# hadoop-daemon.sh start journalnode
[root@server2 local]# hadoop-daemon.sh start journalnode
[root@server3 local]# hadoop-daemon.sh start journalnode
</code></pre><ul>
<li>9、格式化zkfc集群</li>
</ul>
<pre><code>[root@server1 local]# /usr/local/hadoop-2.7.2/bin/hdfs zkfc -formatZK
</code></pre><ul>
<li>10、格式化hdfs文件系统[格式化namenode,接着启动namenode]</li>
</ul>
<pre><code>[root@server1 local]# /usr/local/hadoop-2.7.2/bin/hdfs namenode -format -clusterId mycluster
[root@server1 local]# /usr/local/hadoop-2.7.2/sbin/hadoop-daemon.sh start namenode
[root@server2 local]# /usr/local/hadoop-2.7.2/bin/hdfs namenode -bootstrapStandby
[root@server2 local]# /usr/local/hadoop-2.7.2/sbin/hadoop-daemon.sh start namenode
</code></pre><ul>
<li>11、启动datanode</li>
</ul>
<pre><code>[root@server1 local]# /usr/local/hadoop-2.7.2/sbin/hadoop-daemons.sh start datanode
</code></pre><ul>
<li>12、启动zkfc [DFSZKFailoverController]</li>
</ul>
<pre><code>[root@server1 local]# /usr/local/hadoop-2.7.2/sbin/hadoop-daemon.sh start zkfc
[root@server2 local]# /usr/local/hadoop-2.7.2/sbin/hadoop-daemon.sh start zkfc
</code></pre><ul>
<li>13、启动yarn</li>
</ul>
<pre><code>[root@server1 local]# /usr/local/hadoop-2.7.2/sbin/yarn-daemon.sh start resourcemanager
[root@server1 local]# /usr/local/hadoop-2.7.2/sbin/yarn-daemons.sh start nodemanager
</code></pre><ul>
<li>14、启动historyserver [查询作业执行的详细情况]</li>
</ul>
<pre><code>[root@server1 local]# mr-jobhistory-daemon.sh start historyserver  
</code></pre><h1 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h1><ul>
<li>15、测试hdfs+Yarn+MR</li>
</ul>
<pre><code>/usr/local/hadoop-2.7.2/bin/hadoop fs -put /usr/local/zookeeper.out /test/zookeeper.out
hadoop jar hadoop-mapreduce-examples-2.7.2.jar wordcount /test /output
</code></pre><h1 id="过程日志"><a href="#过程日志" class="headerlink" title="过程日志"></a>过程日志</h1><h2 id="server1"><a href="#server1" class="headerlink" title="server1"></a>server1</h2><p>`<br>[root@server1 local]# hdfs zkfc -formatZK<br>16/07/23 08:13:03 INFO tools.DFSZKFailoverController: Failover controller configured for NameNode NameNode at server1/198.176.49.198:9000<br>16/07/23 08:13:03 INFO zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.6-1569965, built on 02/20/2014 09:09 GMT<br>16/07/23 08:13:03 INFO zookeeper.ZooKeeper: Client environment:host.name=server1<br>16/07/23 08:13:03 INFO zookeeper.ZooKeeper: Client environment:java.version=1.7.0_79<br>16/07/23 08:13:03 INFO zookeeper.ZooKeeper: Client environment:java.vendor=Oracle Corporation<br>16/07/23 08:13:03 INFO zookeeper.ZooKeeper: Client environment:java.home=/usr/local/java/jdk1.7.0_79/jre<br>16/07/23 08:13:03 INFO zookeeper.ZooKeeper: Client environment:java.class.path=/usr/local/hadoop-2.7.2/etc/hadoop:/usr/local/hadoop-2.7.2/share/hadoop/common/lib/jackson-core-asl-1.9.13.jar:/usr<br><strong>此处省去大量lib…</strong><br>p-2.7.2/contrib/capacity-scheduler/<em>.jar<br>16/07/23 08:13:03 INFO zookeeper.ZooKeeper: Client environment:java.library.path=/usr/local/hadoop-2.7.2/lib/native<br>16/07/23 08:13:03 INFO zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp<br>16/07/23 08:13:03 INFO zookeeper.ZooKeeper: Client environment:java.compiler=<na><br>16/07/23 08:13:03 INFO zookeeper.ZooKeeper: Client environment:os.name=Linux<br>16/07/23 08:13:03 INFO zookeeper.ZooKeeper: Client environment:os.arch=amd64<br>16/07/23 08:13:03 INFO zookeeper.ZooKeeper: Client environment:os.version=2.6.32-042stab112.15<br>16/07/23 08:13:03 INFO zookeeper.ZooKeeper: Client environment:user.name=root<br>16/07/23 08:13:03 INFO zookeeper.ZooKeeper: Client environment:user.home=/root<br>16/07/23 08:13:03 INFO zookeeper.ZooKeeper: Client environment:user.dir=/usr/local<br>16/07/23 08:13:03 INFO zookeeper.ZooKeeper: Initiating client connection, connectString=server1:2181,server2:2181,server3:2181 sessionTimeout=5000 watcher=org.apache.hadoop.ha.ActiveStandbyElector$WatcherWithClientRef@25a296b8<br>16/07/23 08:13:03 INFO zookeeper.ClientCnxn: Opening socket connection to server server1/198.176.49.198:2181. Will not attempt to authenticate using SASL (unknown error)<br>16/07/23 08:13:03 INFO zookeeper.ClientCnxn: Socket connection established to server1/198.176.49.198:2181, initiating session<br>16/07/23 08:13:03 INFO zookeeper.ClientCnxn: Session establishment complete on server server1/198.176.49.198:2181, sessionid = 0x15617ab536f0000, negotiated timeout = 20000<br>16/07/23 08:13:03 INFO ha.ActiveStandbyElector: Successfully created /hadoop-ha/mycluster in ZK.<br>16/07/23 08:13:03 INFO zookeeper.ZooKeeper: Session: 0x15617ab536f0000 closed<br>16/07/23 08:13:03 WARN ha.ActiveStandbyElector: Ignoring stale result from old client with sessionId 0x15617ab536f0000<br>16/07/23 08:13:03 INFO zookeeper.ClientCnxn: EventThread shut down<br>[root@server1 local]# hdfs namenode -format -clusterId mycluster<br>16/07/23 08:14:21 INFO namenode.NameNode: STARTUP_MSG:<br>/<strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><em>**</em></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong><br>STARTUP_MSG: Starting NameNode<br>STARTUP_MSG:   host = server1/198.176.49.198<br>STARTUP_MSG:   args = [-format, -clusterId, mycluster]<br>STARTUP_MSG:   version = 2.7.2<br>STARTUP_MSG:   classpath = /usr/local/hadoop-2.7.2/etc/hadoop:/usr/local/hadoop-2.7.2/share/hadoop/common/lib/jackson-core-asl-1.9.13.jar:/usr/local/hadoop-2.7.2/share/hadoop/common/lib/commons-codec-1.4.jar<br><strong>此处省去大量lib…</strong><br>-2.7.2.jar:/usr/local/hadoop-2.7.2/contrib/capacity-scheduler/</na></em>.jar<br>STARTUP_MSG:   build = <a href="https://git-wip-us.apache.org/repos/asf/hadoop.git" target="_blank" rel="external">https://git-wip-us.apache.org/repos/asf/hadoop.git</a> -r b165c4fe8a74265c792ce23f546c64604acf0e41; compiled by ‘jenkins’ on 2016-01-26T00:08Z<br>STARTUP_MSG:   java = 1.7.0_79<br><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><em>**</em></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong>/<br>16/07/23 08:14:21 INFO namenode.NameNode: registered UNIX signal handlers for [TERM, HUP, INT]<br>16/07/23 08:14:21 INFO namenode.NameNode: createNameNode [-format, -clusterId, mycluster]<br>Formatting using clusterid: mycluster<br>16/07/23 08:14:22 INFO namenode.FSNamesystem: No KeyProvider found.<br>16/07/23 08:14:22 INFO namenode.FSNamesystem: fsLock is fair:true<br>16/07/23 08:14:22 INFO blockmanagement.DatanodeManager: dfs.block.invalidate.limit=1000<br>16/07/23 08:14:22 INFO blockmanagement.DatanodeManager: dfs.namenode.datanode.registration.ip-hostname-check=true<br>16/07/23 08:14:22 INFO blockmanagement.BlockManager: dfs.namenode.startup.delay.block.deletion.sec is set to 000:00:00:00.000<br>16/07/23 08:14:22 INFO blockmanagement.BlockManager: The block deletion will start around 2016 Jul 23 08:14:22<br>16/07/23 08:14:22 INFO util.GSet: Computing capacity for map BlocksMap<br>16/07/23 08:14:22 INFO util.GSet: VM type       = 64-bit<br>16/07/23 08:14:22 INFO util.GSet: 2.0% max memory 889 MB = 17.8 MB<br>16/07/23 08:14:22 INFO util.GSet: capacity      = 2^21 = 2097152 entries<br>16/07/23 08:14:22 INFO blockmanagement.BlockManager: dfs.block.access.token.enable=false<br>16/07/23 08:14:22 INFO blockmanagement.BlockManager: defaultReplication         = 2<br>16/07/23 08:14:22 INFO blockmanagement.BlockManager: maxReplication             = 512<br>16/07/23 08:14:22 INFO blockmanagement.BlockManager: minReplication             = 1<br>16/07/23 08:14:22 INFO blockmanagement.BlockManager: maxReplicationStreams      = 2<br>16/07/23 08:14:22 INFO blockmanagement.BlockManager: replicationRecheckInterval = 3000<br>16/07/23 08:14:22 INFO blockmanagement.BlockManager: encryptDataTransfer        = false<br>16/07/23 08:14:22 INFO blockmanagement.BlockManager: maxNumBlocksToLog          = 1000<br>16/07/23 08:14:22 INFO namenode.FSNamesystem: fsOwner             = root (auth:SIMPLE)<br>16/07/23 08:14:22 INFO namenode.FSNamesystem: supergroup          = supergroup<br>16/07/23 08:14:22 INFO namenode.FSNamesystem: isPermissionEnabled = true<br>16/07/23 08:14:22 INFO namenode.FSNamesystem: Determined nameservice ID: mycluster<br>16/07/23 08:14:22 INFO namenode.FSNamesystem: HA Enabled: true<br>16/07/23 08:14:22 INFO namenode.FSNamesystem: Append Enabled: true<br>16/07/23 08:14:22 INFO util.GSet: Computing capacity for map INodeMap<br>16/07/23 08:14:22 INFO util.GSet: VM type       = 64-bit<br>16/07/23 08:14:22 INFO util.GSet: 1.0% max memory 889 MB = 8.9 MB<br>16/07/23 08:14:22 INFO util.GSet: capacity      = 2^20 = 1048576 entries<br>16/07/23 08:14:22 INFO namenode.FSDirectory: ACLs enabled? false<br>16/07/23 08:14:22 INFO namenode.FSDirectory: XAttrs enabled? true<br>16/07/23 08:14:22 INFO namenode.FSDirectory: Maximum size of an xattr: 16384<br>16/07/23 08:14:22 INFO namenode.NameNode: Caching file names occuring more than 10 times<br>16/07/23 08:14:22 INFO util.GSet: Computing capacity for map cachedBlocks<br>16/07/23 08:14:22 INFO util.GSet: VM type       = 64-bit<br>16/07/23 08:14:22 INFO util.GSet: 0.25% max memory 889 MB = 2.2 MB<br>16/07/23 08:14:22 INFO util.GSet: capacity      = 2^18 = 262144 entries<br>16/07/23 08:14:22 INFO namenode.FSNamesystem: dfs.namenode.safemode.threshold-pct = 0.9990000128746033<br>16/07/23 08:14:22 INFO namenode.FSNamesystem: dfs.namenode.safemode.min.datanodes = 0<br>16/07/23 08:14:22 INFO namenode.FSNamesystem: dfs.namenode.safemode.extension     = 30000<br>16/07/23 08:14:22 INFO metrics.TopMetrics: NNTop conf: dfs.namenode.top.window.num.buckets = 10<br>16/07/23 08:14:22 INFO metrics.TopMetrics: NNTop conf: dfs.namenode.top.num.users = 10<br>16/07/23 08:14:22 INFO metrics.TopMetrics: NNTop conf: dfs.namenode.top.windows.minutes = 1,5,25<br>16/07/23 08:14:22 INFO namenode.FSNamesystem: Retry cache on namenode is enabled<br>16/07/23 08:14:22 INFO namenode.FSNamesystem: Retry cache will use 0.03 of total heap and retry cache entry expiry time is 600000 millis<br>16/07/23 08:14:22 INFO util.GSet: Computing capacity for map NameNodeRetryCache<br>16/07/23 08:14:22 INFO util.GSet: VM type       = 64-bit<br>16/07/23 08:14:22 INFO util.GSet: 0.029999999329447746% max memory 889 MB = 273.1 KB<br>16/07/23 08:14:22 INFO util.GSet: capacity      = 2^15 = 32768 entries<br>16/07/23 08:14:24 INFO namenode.FSImage: Allocated new BlockPoolId: BP-1601089490-198.176.49.198-1469276064635<br>16/07/23 08:14:24 INFO common.Storage: Storage directory /home/root/hadoop/tmp/dfs/name has been successfully formatted.<br>16/07/23 08:14:25 INFO namenode.NNStorageRetentionManager: Going to retain 1 images with txid &gt;= 0<br>16/07/23 08:14:26 INFO util.ExitUtil: Exiting with status 0<br>16/07/23 08:14:26 INFO namenode.NameNode: SHUTDOWN_MSG:<br>/<strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><em>**</em></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong><br>SHUTDOWN_MSG: Shutting down NameNode at server1/198.176.49.198<br><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><em>**</em></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong>/<br>[root@server1 local]# hadoop-daemon.sh start namenode<br>starting namenode, logging to /usr/local/hadoop-2.7.2/logs/hadoop-root-namenode-server1.out<br>[root@server1 local]# hadoop-daemons.sh start datanode<br>server3: starting datanode, logging to /usr/local/hadoop-2.7.2/logs/hadoop-root-datanode-server3.out<br>server4: starting datanode, logging to /usr/local/hadoop-2.7.2/logs/hadoop-root-datanode-server4.out<br>[root@server1 local]# hadoop-daemon.sh start zkfc<br>starting zkfc, logging to /usr/local/hadoop-2.7.2/logs/hadoop-root-zkfc-server1.out</p>
<p>.^H[root@server1 local]#<br>[root@server1 local]# yarn-daemon.sh start resourcemanager<br>starting resourcemanager, logging to /usr/local/hadoop-2.7.2/logs/yarn-root-resourcemanager-server1.out<br>[root@server1 local]# yarn-daemons.sh start nodemanager<br>server4: starting nodemanager, logging to /usr/local/hadoop-2.7.2/logs/yarn-root-nodemanager-server4.out<br>server3: starting nodemanager, logging to /usr/local/hadoop-2.7.2/logs/yarn-root-nodemanager-server3.out<br>[root@server1 local]# mr-jobhistory-daemon.sh start historyserver<br>starting historyserver, logging to /usr/local/hadoop-2.7.2/logs/mapred-root-historyserver-server1.out<br>[root@server1 local]# jps<br>2511 Jps<br>2457 JobHistoryServer<br>2071 DFSZKFailoverController<br>1771 QuorumPeerMain<br>1950 NameNode<br>2169 ResourceManager<br>1076 JournalNode<br>[root@server1 local]# zkCli.sh<br>Connecting to localhost:2181<br>2016-07-23 08:19:47,928 [myid:] - INFO  [main:Environment@100] - Client environment:zookeeper.version=3.4.6-1569965, built on 02/20/2014 09:09 GMT<br>2016-07-23 08:19:47,931 [myid:] - INFO  [main:Environment@100] - Client environment:host.name=server1<br>2016-07-23 08:19:47,931 [myid:] - INFO  [main:Environment@100] - Client environment:java.version=1.7.0_79<br>2016-07-23 08:19:47,933 [myid:] - INFO  [main:Environment@100] - Client environment:java.vendor=Oracle Corporation<br>2016-07-23 08:19:47,933 [myid:] - INFO  [main:Environment@100] - Client environment:java.home=/usr/local/java/jdk1.7.0_79/jre<br>2016-07-23 08:19:47,933 [myid:] - INFO  [main:Environment@100] - Client environment:java.class.path=/usr/local/zookeeper-3.4.6/bin/../build/classes:/usr/local/zookeeper-3.4.6/bin/../build/lib/<em>.jar:/usr/local/zookeeper-3.4.6/bin/../lib/slf4j-log4j12-1.6.1.jar:/usr/local/zookeeper-3.4.6/bin/../lib/slf4j-api-1.6.1.jar:/usr/local/zookeeper-3.4.6/bin/../lib/netty-3.7.0.Final.jar:/usr/local/zookeeper-3.4.6/bin/../lib/log4j-1.2.16.jar:/usr/local/zookeeper-3.4.6/bin/../lib/jline-0.9.94.jar:/usr/local/zookeeper-3.4.6/bin/../zookeeper-3.4.6.jar:/usr/local/zookeeper-3.4.6/bin/../src/java/lib/</em>.jar:/usr/local/zookeeper-3.4.6/bin/../conf:.:/usr/local/java/jdk1.7.0_79/lib/dt.jar:/usr/local/java/jdk1.7.0_79/lib/tools.jar<br>2016-07-23 08:19:47,933 [myid:] - INFO  [main:Environment@100] - Client environment:java.library.path=/usr/java/packages/lib/amd64:/usr/lib64:/lib64:/lib:/usr/lib<br>2016-07-23 08:19:47,933 [myid:] - INFO  [main:Environment@100] - Client environment:java.io.tmpdir=/tmp<br>2016-07-23 08:19:47,933 [myid:] - INFO  [main:Environment@100] - Client environment:java.compiler=<na><br>2016-07-23 08:19:47,934 [myid:] - INFO  [main:Environment@100] - Client environment:os.name=Linux<br>2016-07-23 08:19:47,934 [myid:] - INFO  [main:Environment@100] - Client environment:os.arch=amd64<br>2016-07-23 08:19:47,934 [myid:] - INFO  [main:Environment@100] - Client environment:os.version=2.6.32-042stab112.15<br>2016-07-23 08:19:47,934 [myid:] - INFO  [main:Environment@100] - Client environment:user.name=root<br>2016-07-23 08:19:47,934 [myid:] - INFO  [main:Environment@100] - Client environment:user.home=/root<br>2016-07-23 08:19:47,934 [myid:] - INFO  [main:Environment@100] - Client environment:user.dir=/usr/local<br>2016-07-23 08:19:47,935 [myid:] - INFO  [main:ZooKeeper@438] - Initiating client connection, connectString=localhost:2181 sessionTimeout=30000 watcher=org.apache.zookeeper.ZooKeeperMain$MyWatcher@c81739c<br>Welcome to ZooKeeper!<br>2016-07-23 08:19:47,959 [myid:] - INFO  [main-SendThread(localhost.localdomain:2181):ClientCnxn$SendThread@975] - Opening socket connection to server localhost.localdomain/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)<br>2016-07-23 08:19:47,965 [myid:] - INFO  [main-SendThread(localhost.localdomain:2181):ClientCnxn$SendThread@852] - Socket connection established to localhost.localdomain/127.0.0.1:2181, initiating session<br>JLine support is enabled<br>2016-07-23 08:19:47,976 [myid:] - INFO  [main-SendThread(localhost.localdomain:2181):ClientCnxn$SendThread@1235] - Session establishment complete on server localhost.localdomain/127.0.0.1:2181, sessionid = 0x15617ab536f0002, negotiated timeout = 30000</na></p>
<p>WATCHER::</p>
<p>WatchedEvent state:SyncConnected type:None path:null<br>[zk: localhost:2181(CONNECTED) 0] ls /<br>[rmstore, yarn-leader-election, hadoop-ha, zookeeper]<br>[zk: localhost:2181(CONNECTED) 1] ls /hadoop-ha/mycluster<br>[ActiveBreadCrumb, ActiveStandbyElectorLock]</p>
<p>`</p>
<h2 id="server2"><a href="#server2" class="headerlink" title="server2"></a>server2</h2><p>`<br>[root@server2 ~]# zkServer.sh status<br>JMX enabled by default<br>Using config: /usr/local/zookeeper-3.4.6/bin/../conf/zoo.cfg<br>Mode: leader<br>[root@server2 ~]# hdfs namenode -bootstrapStandby<br>16/07/23 08:15:02 INFO namenode.NameNode: STARTUP_MSG:<br>/<strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><em>**</em></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong><br>STARTUP_MSG: Starting NameNode<br>STARTUP_MSG:   host = server2/198.176.49.2<br>STARTUP_MSG:   args = [-bootstrapStandby]<br>STARTUP_MSG:   version = 2.7.2<br>STARTUP_MSG:   classpath = /usr/local/hadoop-2.7.2/etc/hadoop:/usr/local/hadoop-2.7.2/share/hadoop/common/lib/jackson-core-asl-1.9.13.jar:/usr/local/hadoop-2.7.2/share/hadoop/common/lib/commons-code<br><strong>此处省去大量lib…</strong><br>doop.git -r b165c4fe8a74265c792ce23f546c64604acf0e41; compiled by ‘jenkins’ on 2016-01-26T00:08Z<br>STARTUP_MSG:   java = 1.7.0_79<br><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><em>**</em></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong>/<br>16/07/23 08:15:02 INFO namenode.NameNode: registered UNIX signal handlers for [TERM, HUP, INT]<br>16/07/23 08:15:02 INFO namenode.NameNode: createNameNode [-bootstrapStandby]</p>
<p>=====================================================<br>About to bootstrap Standby ID nn2 from:<br>           Nameservice ID: mycluster<br>        Other Namenode ID: nn1<br>  Other NN’s HTTP address: <a href="http://server1:50070" target="_blank" rel="external">http://server1:50070</a><br>  Other NN’s IPC  address: server1/198.176.49.198:9000<br>             Namespace ID: 1284273816<br>            Block pool ID: BP-1601089490-198.176.49.198-1469276064635<br>               Cluster ID: mycluster<br>           Layout version: -63</p>
<pre><code>isUpgradeFinalized: true
</code></pre><p>=====================================================<br>16/07/23 08:15:04 INFO common.Storage: Storage directory /home/root/hadoop/tmp/dfs/name has been successfully formatted.<br>16/07/23 08:15:05 INFO namenode.TransferFsImage: Opening connection to <a href="http://server1:50070/imagetransfer?getimage=1&amp;txid=0&amp;storageInfo=-63:1284273816:0:mycluster" target="_blank" rel="external">http://server1:50070/imagetransfer?getimage=1&amp;txid=0&amp;storageInfo=-63:1284273816:0:mycluster</a><br>16/07/23 08:15:05 INFO namenode.TransferFsImage: Image Transfer timeout configured to 60000 milliseconds<br>16/07/23 08:15:05 INFO namenode.TransferFsImage: Transfer took 0.00s at 0.00 KB/s<br>16/07/23 08:15:05 INFO namenode.TransferFsImage: Downloaded file fsimage.ckpt_0000000000000000000 size 351 bytes.<br>16/07/23 08:15:05 INFO util.ExitUtil: Exiting with status 0<br>16/07/23 08:15:05 INFO namenode.NameNode: SHUTDOWN_MSG:<br>/<strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><em>**</em></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong><br>SHUTDOWN_MSG: Shutting down NameNode at server2/198.176.49.2<br><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><em>**</em></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong>/<br>[root@server2 ~]# hadoop-daemon.sh start namenode<br>starting namenode, logging to /usr/local/hadoop-2.7.2/logs/hadoop-root-namenode-server2.out<br>[root@server2 ~]# hadoop-daemon.sh start zkfc<br>starting zkfc, logging to /usr/local/hadoop-2.7.2/logs/hadoop-root-zkfc-server2.out<br>[root@server2 ~]# jps<br>1613 QuorumPeerMain<br>1886 Jps<br>1007 JournalNode<br>1736 NameNode<br>1825 DFSZKFailoverController<br>[root@server2 ~]#<br>`</p>
<h2 id="server3"><a href="#server3" class="headerlink" title="server3"></a>server3</h2><p>`<br>[root@server3 ~]# zkServer.sh status<br>JMX enabled by default<br>Using config: /usr/local/zookeeper-3.4.6/bin/../conf/zoo.cfg<br>Mode: follower<br>[root@server3 ~]# jps<br>1017 JournalNode<br>1641 NodeManager<br>1750 Jps<br>1538 DataNode<br>1454 QuorumPeerMain<br>[root@server3 ~]# </p>
<p>`</p>
<h2 id="server4"><a href="#server4" class="headerlink" title="server4"></a>server4</h2><p><code>[root@server4 ~]# jps
902 Jps
676 DataNode
793 NodeManager
[root@server4 ~]#</code></p>

      
    </div>
    
    <div>
      
        
      
    </div>

    <div>
      
        
      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Hadoop/" rel="tag">#Hadoop</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/07/23/Hadoop-Cluster-Set-Up-P1-Prepare/" rel="next" title="Hadoop-Cluster-Set-Up-P1_Prepare">
                <i class="fa fa-chevron-left"></i> Hadoop-Cluster-Set-Up-P1_Prepare
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/07/23/Hadoop-Cluster-Set-Up-P4-HBase/" rel="prev" title="Hadoop-Cluster-Set-Up-P4_HBase">
                Hadoop-Cluster-Set-Up-P4_HBase <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
        <!-- JiaThis Button BEGIN -->
<div class="jiathis_style">
  <a class="jiathis_button_tsina"></a>
  <a class="jiathis_button_tqq"></a>
  <a class="jiathis_button_weixin"></a>
  <a class="jiathis_button_cqq"></a>
  <a class="jiathis_button_douban"></a>
  <a class="jiathis_button_renren"></a>
  <a class="jiathis_button_qzone"></a>
  <a class="jiathis_button_kaixin001"></a>
  <a class="jiathis_button_copy"></a>
  <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank"></a>
  <a class="jiathis_counter_style"></a>
</div>
<script type="text/javascript" >
  var jiathis_config={
    hideMore:false
  }
</script>
<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js" charset="utf-8"></script>
<!-- JiaThis Button END -->

      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div class="ds-thread" data-thread-key="2016/07/23/Hadoop-Cluster-Set-Up-P3-Hadoop/"
           data-title="Hadoop-Cluster-Set-Up-P3_Hadoop" data-url="http://www.guinguo.top/2016/07/23/Hadoop-Cluster-Set-Up-P3-Hadoop/">
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/uploads/avatar.png"
               alt="guinguo" />
          <p class="site-author-name" itemprop="name">guinguo</p>
          <p class="site-description motion-element" itemprop="description">guinguo的博客,记录生活中的点点滴滴</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">25</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">10</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">26</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        <div class="links-of-blogroll motion-element">
          
            <div class="links-of-blogroll-title">Links</div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://qiblogs.cc" target="_blank">黄奇blogs</a>
                </li>
              
            </ul>
          
        </div>

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#获取安装包"><span class="nav-number">1.</span> <span class="nav-text">获取安装包</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#修改配置文件"><span class="nav-number">2.</span> <span class="nav-text">修改配置文件</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#复制到其他节点"><span class="nav-number">3.</span> <span class="nav-text">复制到其他节点</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#启动各种服务"><span class="nav-number">4.</span> <span class="nav-text">启动各种服务</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#测试"><span class="nav-number">5.</span> <span class="nav-text">测试</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#过程日志"><span class="nav-number">6.</span> <span class="nav-text">过程日志</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#server1"><span class="nav-number">6.1.</span> <span class="nav-text">server1</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#server2"><span class="nav-number">6.2.</span> <span class="nav-text">server2</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#server3"><span class="nav-number">6.3.</span> <span class="nav-text">server3</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#server4"><span class="nav-number">6.4.</span> <span class="nav-text">server4</span></a></li></ol></li></ol></div>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">guinguo</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>



      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  


  




<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=0.5.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=0.5.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=0.5.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=0.5.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=0.5.0"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"guinguo"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
  





  
  
  

  

  

</body>
</html>
